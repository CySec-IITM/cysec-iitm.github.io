<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><title>3.3 File Inclusion Vulnerabilities</title><meta content="3.3 File Inclusion Vulnerabilities" name=title><meta content="A beginner's guide to File Inclusions and RCEs" name=description><meta content=website property=og:type><meta content=https://cysec-iitm.github.io/resources/file-inc-vuln/ property=og:url><meta content="CyberSecurity Club IITM" property=og:site_name><meta content="3.3 File Inclusion Vulnerabilities" property=og:title><meta content="A beginner's guide to File Inclusions and RCEs" property=og:description><meta content=https://cysec-iitm.github.io/favicon.ico property=og:image><link href=https://cysec-iitm.github.io/resources/file-inc-vuln/ rel=canonical><link rel="shortcut icon" href=https://cysec-iitm.github.io/favicon.ico type=image/x-icon><link href=https://cysec-iitm.github.io/atom.xml rel=alternate title=RSS type=application/atom+xml><link href=/css/style.css rel=stylesheet><body><div class=wrapper><header><nav class=navBar><a href=/>/home/</a><a href=/about>/about/</a><a href=/events>/events/</a><a href=/resources>/resources/</a><div class=themeSwitch><button class="themeButton light" onclick="setTheme('light')" title="Light mode">◐</button><button class="themeButton dark" onclick="setTheme('dark')" title="Dark mode">◑</button></div><script>const setTheme=a=>{document.documentElement.className=a;localStorage.setItem('theme',a)};const getTheme=()=>{const a=localStorage.getItem('theme');a&&setTheme(a)};getTheme()</script></nav><div><a href=..>..</a>/<span class=metaData>file-inc-vuln</span></div><time datetime=2023-08-08>Published on: <span class=metaData>2023-08-08</span></time><h1>3.3 File Inclusion Vulnerabilities</h1></header><main><p>File Inclusion Vulnerabilities refer to a type of security weakness in web applications that can allow an attacker to include files from a remote or local server. These vulnerabilities are typically exploited by manipulating input parameters used to load files or templates within the application’s code. There are two main types of file inclusion vulnerabilities:<ol><li><p><strong>Local File Inclusion (LFI):</strong> In LFI attacks, an attacker manipulates input parameters to force the application to include files that are present on the same server where the application is hosted. This can potentially grant unauthorized access to sensitive system files, configuration files, or other resources.</p><li><p><strong>Remote File Inclusion (RFI):</strong> RFI attacks involve manipulating input parameters to include files from a remote server controlled by the attacker. This can allow the attacker to execute arbitrary code on the victim’s system, potentially leading to complete compromise of the system.</p></ol><p>Both LFI and RFI vulnerabilities are often the result of insufficient input validation or inadequate security controls in the application’s code. Attackers can exploit these vulnerabilities to gain unauthorized access, execute malicious code, or obtain sensitive information from the targeted system.<p>Here’s a simplified example of how an LFI attack could work:<p>Suppose a web application uses a URL parameter to dynamically include files, like so:<pre style=background:#282828;color:#fdf4c1aa><code><span>http://example.com/page.php?file=user_provided_value
</span></code></pre><p>An attacker could manipulate the <code>file</code> parameter to include sensitive files, such as:<pre style=background:#282828;color:#fdf4c1aa><code><span>http://example.com/page.php?file=../../../../etc/passwd
</span></code></pre><p>If the application does not properly validate or sanitize the input, the attacker could potentially retrieve the contents of the <code>/etc/passwd</code> file, which contains information about system users.<p>Preventing File Inclusion Vulnerabilities:<p>To mitigate file inclusion vulnerabilities, developers should follow these best practices:<ol><li><p><strong>Input Validation and Sanitization:</strong> Always validate and sanitize user input before using it to include files or execute code.</p><li><p><strong>Whitelisting:</strong> Maintain a list of allowed files or resources that can be included, and ensure that only these files are accessible.</p><li><p><strong>Avoid Dynamic Includes:</strong> Whenever possible, avoid using dynamic file inclusion mechanisms and instead use static paths or libraries.</p><li><p><strong>Limit Permissions:</strong> Restrict the file system permissions for web application files to minimize the potential impact of a successful attack.</p><li><p><strong>Web Application Firewall (WAF):</strong> Implement a WAF to detect and block suspicious file inclusion attempts.</p><li><p><strong>Regular Security Audits:</strong> Conduct regular security assessments and penetration testing to identify and address vulnerabilities.</p></ol><p>File inclusion vulnerabilities can pose serious security risks, but with proper coding practices and security measures, they can be effectively mitigated.<p>More resources on this:<ul><li><a href=https://en.wikipedia.org/wiki/File_inclusion_vulnerability rel=noopener target=_blank>Wikipedia</a><li><a href=https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion rel=noopener target=_blank>OWASP Local File Inclusions</a></ul><span class=webring> <a href=#>Go to the Top</a> </span></main><footer><p class=tagsData><a href=/tags/web-exploitation>#web exploitation</a> <a href=/tags/file-inclusion-vulnerabilities>#file inclusion vulnerabilities</a> <a href=/tags/rce>#RCE</a><hr><div class=footContainer><div class=footLeft><p>Licensed under <a rel="noopener noreferrer" href=https://fr.wikipedia.org/wiki/Licence_MIT target=_blank>MIT</a><br></div><div class=footRight><img class="footGif noStyle" alt=footGif loading=lazy src=https://i.ibb.co/XYDpfcs/foot.gif><a rel="noopener noreferrer" title="Subscribe via RSS for updates." class=metaData href=https://cysec-iitm.github.io/atom.xml target=_blank>RSS</a></div></div></footer></div>